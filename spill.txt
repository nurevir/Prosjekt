import pygame

# importerer klasser
from flappy import Flappy
from bakke import Bakke
from bakgrunn import Bakgrunn
from pipe1 import Pipe1
from pipe2 import Pipe2
from pipe3 import Pipe3
from pipe4 import Pipe4
from pipe5 import Pipe5
from pipe6 import Pipe6
from pipe7 import Pipe7
from pipe8 import Pipe8

# 1. Oppsett
pygame.init()

# Spillvindu og klokke
BREDDE = 440
HOYDE = 490
FPS = 60
vindu = pygame.display.set_mode((BREDDE, HOYDE))
klokke = pygame.time.Clock()
stor_font = pygame.font.SysFont("Arial", 30)
liten_font = pygame.font.SysFont("Arial", 12) 

# Opprett objekter

#flappy
flappy = Flappy("bilder/flappy.jpg", 175, 200)

#bakgrunn
bakgrunn = Bakgrunn("bilder/bakgrunn1.jpg",0, 0)

#bakke
bakke = Bakke("bilder/bakke.jpg", 0, 420)


#pipe 1
pipe1 = Pipe1("bilder/pipe1.png", 50,250)

#pipe 3
pipe3 = Pipe3("bilder/pipe3.png", 50,0)



#pipe 2
pipe2 = Pipe2("bilder/pipe2.png", 190,230)

#pipe 4
pipe4 = Pipe4("bilder/pipe4.png", 190,0)


#pipe 5
pipe5 = Pipe5("bilder/pipe4.png", 330,0)

#pipe 6
pipe6 = Pipe6("bilder/pipe6.png", 330,190)


#pipe 7
pipe7 = Pipe7("bilder/pipe7.png", 490,0)

#pipe 8
pipe8 = Pipe8("bilder/pipe8.png", 490,310)

# Spill-løkke
while True:
    # Håndter input
    for event in pygame.event.get():
        if event.type == pygame.QUIT:
            pygame.quit()
            raise SystemExit
        if event.type == pygame.KEYDOWN:
            if event.key == pygame.K_ESCAPE:
                pygame.quit()
                raise SystemExit

    # Oppdater spill
        if flappy.ramme.colliderect(pipe1.ramme):
            pygame.quit
            raise SystemExit

    flappy.fly()
    bakke.beveg()
    pipe1.beveg()
    pipe2.beveg()
    pipe3.beveg()
    pipe4.beveg()
    pipe5.beveg()
    pipe6.beveg()
    pipe7.beveg()
    pipe8.beveg()

    # Tegn (print)
    vindu.fill("white")
    bakgrunn.tegn(vindu)
    bakke.tegn(vindu)
    flappy.tegn(vindu)
    pipe1.tegn(vindu)
    pipe2.tegn(vindu)
    pipe3.tegn(vindu)
    pipe4.tegn(vindu)
    pipe5.tegn(vindu)
    pipe6.tegn(vindu)
    pipe7.tegn(vindu)
    pipe8.tegn(vindu)

    tekst = stor_font.render("Flappy bird", True, "white")
    vindu.blit(tekst, (20, 20))

    print("En runde i gameloopen")
    pygame.display.flip()
    klokke.tick(FPS)


    ## Tegn (print)
    vindu.fill("white")

    if not game_over:
        bakgrunn.tegn(vindu)
        bakke.tegn(vindu)
        flappy.tegn(vindu)

        for pipe in pipes:
            pipe.tegn(vindu)

        tekst_flappy = stor_font.render("Flappy bird", True, "white")
        vindu.blit(tekst_flappy, (20, 20))

        if game_started:
            tekst_poeng = stor_font.render(f"Poeng: {poeng}", True, "white")
            vindu.blit(tekst_poeng, (20, 60))
        else:
            # Hvis spillet ikke har startet
            start_tekst = stor_font.render("Trykk SPACE for å starte", True, "black")
            vindu.blit(start_tekst, (50,245))
    else:
        # Hvis det er game over
        tekst = stor_font.render("Game Over", True, "red")
        vindu.blit(tekst,(175,245))
        tekst_poeng = stor_font.render(f"Poeng: {poeng}", True, "red")
        vindu.blit(tekst_poeng, (20, 60))

    pygame.display.flip()
    klokke.tick(FPS)